1<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Two Little Bees Auto Parts | VIN-Verified OEM Used Parts | Indianapolis</title>

<meta name="color-scheme" content="dark">
<meta name="theme-color" content="#0b0f14">
<meta name="description" content="Two Little Bees Auto Parts in Indianapolis ‚Äî VIN-verified OEM used parts. Engines, transmissions, modules, body parts, wheels, and more. Fast counter support.">
<meta name="robots" content="index,follow">
<link rel="canonical" href="https://twolittlebeesautoparts.github.io/OFFICIALPAGE/">

<!-- Open Graph / Social Preview -->
<meta property="og:type" content="website">
<meta property="og:title" content="Two Little Bees Auto Parts ‚Äî VIN-Verified OEM Used Parts">
<meta property="og:description" content="Indianapolis OEM used parts. Engines, transmissions, modules, body parts, wheels & more. Request a part, decode VIN, or get directions.">
<meta property="og:url" content="https://twolittlebeesautoparts.github.io/OFFICIALPAGE/">
<meta property="og:image" content="https://github.com/twolittlebeesautoparts/OFFICIALPAGE/blob/main/new.logo.png?raw=true">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Two Little Bees Auto Parts ‚Äî VIN-Verified OEM Used Parts">
<meta name="twitter:description" content="Indianapolis OEM used parts. Request a part, decode VIN, or call now.">
<meta name="twitter:image" content="https://github.com/twolittlebeesautoparts/OFFICIALPAGE/blob/main/new.logo.png?raw=true">

<link rel="preconnect" href="https://vpic.nhtsa.dot.gov">
<link rel="preconnect" href="https://www.gstatic.com">
<link rel="preconnect" href="https://identitytoolkit.googleapis.com">
<link rel="preconnect" href="https://github.com">
<link rel="preload" as="image" href="https://github.com/twolittlebeesautoparts/OFFICIALPAGE/blob/main/new.logo.png?raw=true">

<style>
:root{
  /* Apple-ish dark */
  --bg:#000000;
  --bg2:#050608;
  --text:#f5f5f7;
  --muted:rgba(245,245,247,.72);

  /* Glass + separators */
  --glass:rgba(18,18,20,.62);
  --glass2:rgba(28,28,30,.55);
  --line:rgba(255,255,255,.10);
  --line2:rgba(255,255,255,.14);

  /* Your brand accent kept */
  --accent:#f4c430;
  --accent2:#ffb703;

  /* Apple radii + shadow */
  --r-xl:28px;
  --r-lg:22px;
  --r-md:16px;

  --shadow: 0 18px 60px rgba(0,0,0,.55);
  --shadow2: 0 10px 30px rgba(0,0,0,.38);

  --ring: 0 0 0 4px rgba(244,196,48,.18);
}

*{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;max-width:100%;overflow-x:hidden}
html{scroll-behavior:smooth}

body{
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  color:var(--text);
  background:
    radial-gradient(1200px 650px at 10% -20%, rgba(244,196,48,.16), transparent 55%),
    radial-gradient(900px 520px at 90% 0%, rgba(255,183,3,.10), transparent 55%),
    radial-gradient(900px 520px at 40% 120%, rgba(244,196,48,.08), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,.04), transparent 24%),
    linear-gradient(180deg, var(--bg2), var(--bg));
  padding-left:env(safe-area-inset-left);
  padding-right:env(safe-area-inset-right);
  padding-top:env(safe-area-inset-top);
  padding-bottom:calc(env(safe-area-inset-bottom) + 86px);
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
  letter-spacing:-.15px;
}

a,button{-webkit-tap-highlight-color:transparent}
button{font-family:inherit}
:focus-visible{outline:none;box-shadow:var(--ring);border-radius:16px}

/* ===== Header (Apple glass) ===== */
header{
  position:sticky;top:0;z-index:100;
  background:rgba(10,10,12,.58);
  backdrop-filter: blur(22px) saturate(160%);
  -webkit-backdrop-filter: blur(22px) saturate(160%);
  border-bottom:1px solid rgba(255,255,255,.08);
}
.header-inner{
  max-width:1200px;margin:0 auto;
  padding:14px 16px;
  display:flex;align-items:center;justify-content:space-between;gap:12px;
}
.brand{display:flex;align-items:center;gap:12px;min-width:0}
.logoMark{
  height:54px;
  width:min(560px, 42vw);
  display:flex;align-items:center;justify-content:flex-start;
}
.logoMark img{
  max-height:200%;
  max-width:100%;
  width:auto;height:auto;
  display:block;
  object-fit:contain;
  filter: drop-shadow(0 14px 28px rgba(0,0,0,.35));
}

/* Apple-ish nav pills (minimal, soft) */
nav{
  display:flex;align-items:center;gap:8px;
  overflow-x:auto;-webkit-overflow-scrolling:touch;
  scrollbar-width:none;
}
nav::-webkit-scrollbar{display:none}
nav a{
  text-decoration:none;
  font-weight:650;
  font-size:.92rem;
  color:rgba(245,245,247,.88);
  padding:10px 14px;
  border-radius:999px;
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.10);
  transition: transform .12s ease, background .12s ease, border-color .12s ease, filter .12s ease;
  white-space:nowrap;
}
nav a:hover{
  background:rgba(255,255,255,.07);
  border-color:rgba(255,255,255,.16);
  transform: translateY(-1px);
}
nav a:active{transform:translateY(0) scale(.99)}
nav a.cta{
  color:#0b0f14;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  border:none;
  box-shadow:0 16px 40px rgba(244,196,48,.18);
}
nav a.vin-btn{
  background:rgba(255,255,255,.035);
  border:1px solid rgba(255,255,255,.10);
}

/* ===== Layout ===== */
.container{max-width:1200px;margin:0 auto;padding:0 16px}
.section{padding:44px 0}

/* HERO like Apple product page */
.hero{
  padding:70px 0 36px;
  display:grid;
  grid-template-columns: 1.05fr .95fr;
  gap:22px;
  align-items:start;
}
.hero h1{
  font-weight:780;
  font-size:clamp(2.25rem, 4.9vw, 3.6rem);
  line-height:1.02;
  letter-spacing:-1.2px;
}
.hero p{
  margin-top:16px;
  color:var(--muted);
  max-width:62ch;
  line-height:1.6;
  font-size:1.04rem;
}

/* badges = Apple small chips */
.badges{display:flex;flex-wrap:wrap;gap:10px;margin-top:16px}
.badge{
  display:inline-flex;align-items:center;gap:10px;
  padding:10px 14px;
  border-radius:999px;
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.10);
  font-weight:650;
  color:rgba(245,245,247,.92);
}
.badge .dot{
  width:8px;height:8px;border-radius:50%;
  background:var(--accent);
  box-shadow:0 0 0 4px rgba(244,196,48,.14);
}

/* Buttons like iOS */
.btnRow{display:flex;flex-wrap:wrap;gap:12px;margin-top:18px}
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:10px;
  padding:14px 16px;
  border-radius:999px;
  font-weight:680;
  text-decoration:none;
  user-select:none;
  transition: transform .12s ease, filter .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
}
.btn:active{transform:scale(.99)}
.btn.primary{
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#0b0f14;border:none;
  box-shadow:0 18px 52px rgba(244,196,48,.16);
}
.btn.secondary{
  background:rgba(255,255,255,.05);
  color:var(--text);
  border:1px solid rgba(255,255,255,.10);
}
.btn.secondary:hover{
  background:rgba(255,255,255,.07);
  border-color:rgba(255,255,255,.16);
  box-shadow:0 12px 34px rgba(0,0,0,.30);
}

/* Cards = Apple glass panels */
.card{
  background:
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
    rgba(20,20,22,.55);
  border:1px solid rgba(255,255,255,.10);
  border-radius:var(--r-xl);
  box-shadow:var(--shadow2);
  padding:20px;
  backdrop-filter: blur(18px) saturate(140%);
  -webkit-backdrop-filter: blur(18px) saturate(140%);
}
.card h3{
  font-size:1.05rem;
  font-weight:720;
  letter-spacing:-.3px;
}

/* What we sell grid */
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:14px}
.pillItem{
  display:flex;align-items:center;gap:10px;
  padding:14px 14px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  color:rgba(245,245,247,.80);
  font-weight:650;
  transition: transform .12s ease, border-color .12s ease, background .12s ease;
}
.pillItem:hover{
  transform:translateY(-2px);
  border-color:rgba(255,255,255,.16);
  background:rgba(255,255,255,.055);
}
.pillItem b{
  width:22px;height:22px;border-radius:50%;
  display:grid;place-items:center;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#0b0f14;font-size:.74rem;
  flex:0 0 auto;
}

/* stats = clean Apple tiles */
.stats{margin-top:18px;display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.stat{
  padding:16px 14px;
  border-radius:20px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  text-align:left;
}
.stat strong{display:block;color:var(--text);font-size:1.2rem;font-weight:780}
.stat span{display:block;margin-top:6px;color:var(--muted);font-size:.92rem;font-weight:650}

/* section headers */
.sectionTitleRow{
  display:flex;align-items:center;justify-content:space-between;
  gap:10px;margin-bottom:12px
}
.sectionTitleRow small{color:var(--muted);font-weight:650}

/* Admin outline ONLY in adminMode */
body.adminMode .admin-edit{
  outline:2px dashed rgba(244,196,48,.62);
  outline-offset:8px;
  border-radius:18px;
  padding:12px;
}

/* Forms = Apple inputs */
.formGrid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
.formGrid .full{grid-column:1 / -1}
.field label{
  display:block;
  font-size:.88rem;
  color:var(--muted);
  font-weight:650;
  margin-bottom:8px;
}
.field input, textarea, select{
  width:100%;
  padding:14px 14px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.03);
  color:var(--text);
  font-weight:600;
  transition: border-color .12s ease, background .12s ease, box-shadow .12s ease;
}
.field input:hover, textarea:hover, select:hover{
  border-color:rgba(255,255,255,.16);
  background:rgba(255,255,255,.04);
}
.field input:focus, textarea:focus, select:focus{
  border-color:rgba(244,196,48,.40);
  box-shadow:0 0 0 4px rgba(244,196,48,.12);
  outline:none;
}
textarea{min-height:120px;resize:vertical}

.miniNote{margin-top:12px;color:var(--muted);font-size:.92rem;line-height:1.45}

/* Notices */
.notice{
  margin-top:12px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  border-radius:20px;
  padding:14px;
  color:rgba(245,245,247,.92);
  font-weight:650;
  line-height:1.45;
}
.notice.ok{border-color:rgba(34,197,94,.30)}
.notice.bad{border-color:rgba(239,68,68,.28)}

/* Live stats + trust layouts */
.liveStatsGrid{display:grid;grid-template-columns:1.2fr .8fr;gap:12px;margin-top:12px}
.liveStatCard{
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  border-radius:24px;
  padding:16px;
}
.liveRow{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:12px 14px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
}
.liveRow b{font-weight:700}
.liveNum{font-weight:800;color:var(--text);letter-spacing:-.3px}
.liveMeta{color:var(--muted);font-weight:650;font-size:.9rem;line-height:1.45}

.trustGrid{display:grid;grid-template-columns:1.1fr .9fr;gap:12px;margin-top:12px}
.quoteCard{
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  border-radius:24px;
  padding:16px;
}
.quoteCard p{color:rgba(245,245,247,.92);line-height:1.55;font-weight:600}
.quoteCard small{display:block;margin-top:10px;color:var(--muted);font-weight:650}
.trustList{display:grid;gap:12px}
.trustItem{
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  border-radius:24px;
  padding:14px;
  line-height:1.45;
}
.trustItem b{color:var(--text);font-weight:750}
.trustItem span{color:var(--muted);font-weight:650}

/* Gallery tabs */
.tabs{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
.tab{
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  color:rgba(245,245,247,.85);
  border-radius:999px;
  padding:10px 14px;
  font-weight:650;
  cursor:pointer;
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
}
.tab:hover{transform:translateY(-1px);border-color:rgba(255,255,255,.16)}
.tab.active{
  color:#0b0f14;
  border:none;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
}

/* Gallery carousel cards */
.galleryWrap{position:relative;margin-top:12px}
#galleryGrid{
  display:flex;gap:14px;
  overflow-x:auto;
  padding:10px 6px 14px;
  scroll-snap-type:x mandatory;
  scroll-behavior:smooth;
  -webkit-overflow-scrolling:touch;
  scrollbar-width:none;
}
#galleryGrid::-webkit-scrollbar{display:none}
.galleryItem{
  flex:0 0 auto;
  width:240px;
  aspect-ratio: 3/4;
  scroll-snap-align:start;
  border-radius:26px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  overflow:hidden;
  position:relative;
  box-shadow:var(--shadow2);
  cursor:pointer;
  transition: transform .14s ease, border-color .14s ease;
  display:grid;
  place-items:center;
  color:rgba(245,245,247,.75);
  font-weight:650;
}
.galleryItem:hover{transform:translateY(-3px);border-color:rgba(255,255,255,.16)}
.galleryItem img{width:100%;height:100%;object-fit:cover;display:block}
.galleryItem::after{
  content:"";
  position:absolute;inset:0;
  background:linear-gradient(180deg, transparent 58%, rgba(0,0,0,.65) 100%);
  pointer-events:none;
}
.galleryItem .cap{
  position:absolute;left:12px;right:12px;bottom:12px;
  background:rgba(10,10,12,.55);
  border:1px solid rgba(255,255,255,.10);
  padding:9px 12px;border-radius:16px;
  color:rgba(245,245,247,.95);
  font-size:.85rem;font-weight:650;
  backdrop-filter: blur(16px) saturate(140%);
}
.galleryItem .del{
  position:absolute;top:12px;right:12px;
  background:rgba(10,10,12,.55);
  border:1px solid rgba(255,255,255,.12);
  color:#fff;border-radius:14px;padding:8px 10px;
  font-weight:700;cursor:pointer;display:none;
  backdrop-filter: blur(16px) saturate(140%);
}
.galleryItem.admin .del{display:block}

/* Gallery nav */
.galleryNav{
  position:absolute;top:50%;transform:translateY(-50%);
  width:44px;height:44px;border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(10,10,12,.55);
  color:rgba(245,245,247,.95);
  cursor:pointer;
  box-shadow:var(--shadow2);
  backdrop-filter: blur(18px) saturate(140%);
  z-index:3;
}
.galleryNav:active{transform:translateY(-50%) scale(.98)}
.galleryNav.left{left:10px}
.galleryNav.right{right:10px}
.galleryNav[disabled]{opacity:.35;pointer-events:none}

/* Footer */
footer{
  margin-top:10px;
  border-top:1px solid rgba(255,255,255,.08);
  padding:30px 16px 96px;
}
.footer-inner{max-width:1200px;margin:0 auto;display:grid;gap:14px}
.footerRow{
  display:flex;flex-wrap:wrap;
  justify-content:space-between;gap:14px;
}
footer span{color:var(--muted);font-size:.95rem;line-height:1.45}
.footerLinks{display:flex;flex-wrap:wrap;gap:10px}
.footerLinks a{
  color:rgba(245,245,247,.92);
  text-decoration:none;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  padding:10px 14px;border-radius:999px;
  font-weight:650;font-size:.9rem;
}
.footerLinks a:hover{border-color:rgba(255,255,255,.16);background:rgba(255,255,255,.06)}

/* VIN panel glass */
#vin-panel-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.62);display:none;z-index:997}
#vin-panel{
  position:fixed;left:50%;transform:translateX(-50%);
  bottom:18px;width:380px;max-height:82vh;
  background:rgba(10,10,12,.68);
  border-radius:24px;padding:14px;
  display:none;z-index:998;
  border:1px solid rgba(255,255,255,.10);
  backdrop-filter: blur(20px) saturate(150%);
  box-shadow:var(--shadow);
}
#vin-head{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}
#vin-close{
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  color:#fff;border-radius:14px;padding:10px 12px;
  font-weight:650;cursor:pointer;
}
#vin-meta{color:var(--muted);font-size:.88rem;margin-bottom:10px;line-height:1.35}
#vin-panel input{
  width:100%;padding:14px;border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  color:#fff;text-transform:uppercase;letter-spacing:.7px;
}
#vin-actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
#vin-panel button{
  width:100%;padding:12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.05);
  color:#fff;font-weight:650;cursor:pointer;
}
#vin-panel button.primary{
  border:none;
  color:#0b0f14;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
}
#vin-panel button.secondary:hover,
#vin-panel button:hover{
  background:rgba(255,255,255,.07);
  border-color:rgba(255,255,255,.16);
}

/* VIN results rows (so it doesn't look raw) */
#vehicle{
  margin-top:12px;
  font-weight:820;
  letter-spacing:-.3px;
}
#results{
  margin-top:12px;
  display:grid;
  gap:10px;
}
#results .row{
  display:grid;
  grid-template-columns: .9fr 1.1fr;
  gap:10px;
  padding:12px 12px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  cursor:pointer;
}
#results .row .k{color:var(--muted);font-weight:750}
#results .row .v{color:rgba(245,245,247,.95);font-weight:750;word-break:break-word}

/* VIN status strip */
#vin-status{
  margin-top:10px;
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.03);
  color:rgba(245,245,247,.92);
  font-weight:650;
}
#vin-status .dot{
  width:8px;height:8px;border-radius:50%;
  background:rgba(245,245,247,.35);
  box-shadow:0 0 0 4px rgba(255,255,255,.10);
}
#vin-status.ok{border-color:rgba(34,197,94,.30)}
#vin-status.ok .dot{background:#22c55e;box-shadow:0 0 0 4px rgba(34,197,94,.18)}
#vin-status.bad{border-color:rgba(239,68,68,.28)}
#vin-status.bad .dot{background:#ef4444;box-shadow:0 0 0 4px rgba(239,68,68,.16)}
#vin-status.warn{border-color:rgba(244,196,48,.26)}
#vin-status.warn .dot{background:var(--accent);box-shadow:0 0 0 4px rgba(244,196,48,.14)}

/* Toast */
.toast{
  position:fixed;
  left:50%;
  bottom:92px;
  transform:translateX(-50%);
  z-index:99999;
  padding:10px 14px;
  border-radius:999px;
  background:rgba(10,10,12,.72);
  border:1px solid rgba(255,255,255,.12);
  color:rgba(245,245,247,.95);
  font-weight:750;
  box-shadow:var(--shadow2);
  backdrop-filter: blur(18px) saturate(140%);
  display:none;
}

/* Sticky dock = iOS bottom bar */
#ctaDock{
  position:fixed;left:0;right:0;bottom:0;z-index:9990;
  padding:12px 12px calc(env(safe-area-inset-bottom) + 12px);
  background:rgba(10,10,12,.58);
  backdrop-filter: blur(22px) saturate(160%);
  border-top:1px solid rgba(255,255,255,.08);
}
.ctaInner{
  max-width:1200px;margin:0 auto;
  display:grid;grid-template-columns:repeat(4,1fr);gap:10px;
}
.ctaBtn{
  display:flex;align-items:center;justify-content:center;gap:8px;
  padding:12px 10px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  color:#fff;text-decoration:none;font-weight:650;
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
}
.ctaBtn:hover{background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.16);transform:translateY(-1px)}
.ctaBtn.primary{
  border:none;color:#0b0f14;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
}

/* Responsive */
@media(max-width:900px){
  .hero{grid-template-columns:1fr;padding:52px 0 28px}
  .liveStatsGrid{grid-template-columns:1fr}
}
@media(max-width:600px){
  .header-inner{flex-wrap:wrap;justify-content:center;gap:10px}
  .brand{width:100%;justify-content:center}
  .logoMark{width:min(720px, 92vw);height:64px;justify-content:center}
  nav{width:100%;justify-content:flex-start;padding-bottom:6px}
  .container{padding:0 12px}
  .btnRow .btn{width:100%}
  .stats{grid-template-columns:1fr}
  .grid2{grid-template-columns:1fr}
  .formGrid{grid-template-columns:1fr}
  .trustGrid{grid-template-columns:1fr}
  #vin-panel{left:0;right:0;bottom:env(safe-area-inset-bottom);width:100%;transform:none;border-radius:24px 24px 0 0}
  .galleryItem{width:78vw;max-width:360px}
  .galleryNav{display:none}
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{scroll-behavior:auto !important}
  nav a, .btn, .pillItem, .galleryItem, .ctaBtn, .tab{transition:none !important}
}

/* Hide Car Parts links (your request) */
nav a[href="parts.html"],
.footerLinks a[href="parts.html"]{display:none !important}

/* =========================================================
   ‚úÖ FIXED: MODALS + LIGHTBOX (Apple overlays, centered)
   This is what was missing and causing your screenshot issue
   ========================================================= */

/* Backdrops (real overlays) */
#adminModalBackdrop,
#addModalBackdrop,
#lightboxBackdrop{
  position:fixed;
  inset:0;
  background: rgba(0,0,0,.62);
  backdrop-filter: blur(10px) saturate(140%);
  -webkit-backdrop-filter: blur(10px) saturate(140%);
  z-index: 99950;
  display:none;
}

/* Modal base */
#adminModal,
#addModal{
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(520px, calc(100vw - 24px));
  max-height: min(82vh, 760px);
  overflow:auto;
  padding: 16px;
  border-radius: 26px;
  background:
    linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.02)),
    rgba(10,10,12,.72);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: var(--shadow);
  z-index: 99960;
  display:none;
}

/* Modal header row */
.modalHead{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom: 10px;
}
.modalHead strong{
  font-size: 1.05rem;
  font-weight: 820;
  letter-spacing: -.3px;
}

/* Close button */
.iconBtn{
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  color: rgba(245,245,247,.95);
  padding: 10px 12px;
  border-radius: 999px;
  font-weight: 750;
  cursor:pointer;
}
.iconBtn:hover{
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.16);
}

/* Modal actions row */
.modalActions{
  display:flex;
  gap:10px;
  justify-content:flex-end;
  align-items:center;
  margin-top: 12px;
}
.modalActions .btn{
  padding: 12px 14px;
}

/* Helper text */
.helper{
  margin-top: 10px;
  padding: 12px 14px;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.03);
  color: var(--muted);
  font-weight: 650;
  line-height: 1.45;
}

/* Make fields inside modals look consistent */
#adminModal .field,
#addModal .field{
  margin-top: 10px;
}

/* LIGHTBOX */
#lightboxBackdrop{
  display:none;
}
#lightboxBackdrop[aria-hidden="false"]{ display:block; }

#lightboxModal{
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(980px, calc(100vw - 24px));
  height: min(86vh, 860px);
  border-radius: 28px;
  overflow:hidden;
  background: rgba(10,10,12,.72);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: var(--shadow);
}

#lbStage{
  position:absolute;
  inset: 0;
  display:grid;
  place-items:center;
  background: radial-gradient(900px 520px at 50% 20%, rgba(255,255,255,.06), transparent 60%);
}
#lbImg{
  max-width: 96%;
  max-height: 84%;
  object-fit: contain;
  border-radius: 18px;
  box-shadow: var(--shadow2);
  background: rgba(0,0,0,.18);
}

#lbClose{
  position:absolute;
  top: 14px;
  right: 14px;
  z-index: 3;
  width: 44px;
  height: 44px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(10,10,12,.58);
  color: rgba(245,245,247,.95);
  font-weight: 900;
  cursor:pointer;
  backdrop-filter: blur(18px) saturate(140%);
}

.lbArrow{
  position:absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 3;
  width: 48px;
  height: 48px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(10,10,12,.58);
  color: rgba(245,245,247,.95);
  font-size: 26px;
  cursor:pointer;
  backdrop-filter: blur(18px) saturate(140%);
}
#lbPrev{ left: 14px; }
#lbNext{ right: 14px; }

.lbCap{
  position:absolute;
  left: 14px;
  right: 14px;
  bottom: 14px;
  z-index: 3;
  padding: 12px 14px;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(10,10,12,.58);
  color: rgba(245,245,247,.92);
  font-weight: 650;
  backdrop-filter: blur(18px) saturate(140%);
}

/* Mobile sheet behavior */
@media(max-width:600px){
  #adminModal,#addModal{
    top: auto;
    bottom: 0;
    left: 0;
    right: 0;
    transform: none;
    width: 100%;
    max-height: 86vh;
    border-radius: 24px 24px 0 0;
  }
  #lightboxModal{
    width: 100%;
    height: 100%;
    border-radius: 0;
  }
}
</style>

<!-- LocalBusiness Structured Data -->
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"AutoPartsStore",
  "name":"Two Little Bees Auto Parts",
  "url":"https://twolittlebeesautoparts.github.io/OFFICIALPAGE/",
  "image":"https://github.com/twolittlebeesautoparts/OFFICIALPAGE/blob/main/new.logo.png?raw=true",
  "telephone":"+1-317-243-7777",
  "address":{
    "@type":"PostalAddress",
    "streetAddress":"507 S Tibbs Ave",
    "addressLocality":"Indianapolis",
    "addressRegion":"IN",
    "addressCountry":"US"
  },
  "areaServed":"Indianapolis, IN",
  "description":"VIN-verified OEM used parts ‚Äî engines, transmissions, modules, body parts, wheels and more."
}
</script>
</head>

<body>
<div class="toast" id="toast">Copied</div>

<header>
  <div class="header-inner">
    <div class="brand">
      <div class="logoMark">
        <img
          alt="Two Little Bees Auto Parts"
          src="https://github.com/twolittlebeesautoparts/OFFICIALPAGE/blob/main/new.logo.png?raw=true"
        />
      </div>
    </div>

    <nav>
      <a href="#top">Home</a>
      <a class="cta" href="https://twolittlebeesautoparts.github.io/OFFICIALPAGE/">Inventory</a>
      <a href="#request">Request a Part</a>
      <a href="#junkcars">Cash for Junk Cars</a>
      <a href="javascript:void(0)" class="vin-btn" onclick="toggleVin()">VIN</a>
    </nav>
  </div>
</header>

<main id="top">
  <div class="container">

    <!-- HERO -->
    <section class="hero">
      <div>
        <h1>The Right Parts.<br>Every Time.<br>Built on Trust.</h1>

        <div class="badges">
          <div class="badge"><span class="dot"></span> Established in Indianapolis</div>
          <div class="badge"><span class="dot"></span> VIN-Verified</div>
          <div class="badge"><span class="dot"></span> Fast Counter Support</div>
        </div>

        <p>Live inventory tied to real vehicles. Call or request a quote ‚Äî we verify fitment, move fast, and keep it simple.</p>

        <div class="btnRow">
          <a class="btn primary" href="https://twolittlebeesautoparts.github.io/">Search Inventory</a>
          <a class="btn secondary" href="#request">üí¨ Request a Part</a>
          <a class="btn secondary" href="tel:3172437777">üìû Call (317) 243-7777</a>
          <a class="btn secondary" href="https://www.google.com/maps?q=507+S+Tibbs+Ave,+Indianapolis,+IN" target="_blank" rel="noopener">Get Directions</a>
        </div>

        <div class="stats">
          <div class="stat"><strong>10K+</strong><span>OEM Parts</span></div>
          <div class="stat"><strong>1985‚Äì2026</strong><span>Coverage</span></div>
          <div class="stat"><strong>Trusted</strong><span>Local Pros</span></div>
        </div>
      </div>

      <div class="card">
        <h3>What We Sell</h3>
        <div class="grid2">
          <div class="pillItem"><b>‚úì</b> Engines & Transmissions</div>
          <div class="pillItem"><b>‚úì</b> Suspension & Drivetrain</div>
          <div class="pillItem"><b>‚úì</b> Body & Interior</div>
          <div class="pillItem"><b>‚úì</b> Electrical Modules</div>
          <div class="pillItem"><b>‚úì</b> OEM Used Parts</div>
          <div class="pillItem"><b>‚úì</b> VIN-Verified Fitment</div>
        </div>
      </div>
    </section>

    <!-- LIVE SITE STATS -->
    <section class="liveStatsWrap" aria-label="Live Site Stats">
      <div class="liveStatsGrid">
        <div class="liveStatCard">
          <div class="sectionTitleRow" style="margin-bottom:0">
            <h3>Live Site Stats</h3>
            <small id="metricsUpdated">Loading‚Ä¶</small>
          </div>

          <div class="liveRow">
            <b>Pageviews</b>
            <span class="liveNum" id="pvNum">‚Äî</span>
          </div>
          <div class="liveRow">
            <b>Unique Visitors</b>
            <span class="liveNum" id="uvNum">‚Äî</span>
          </div>

          <div class="liveMeta">
            * Pageviews go up every refresh. Unique Visitors counts once per device/browser (so your own testing won‚Äôt spam it).
          </div>
        </div>

        <div class="liveStatCard">
          <h3 style="margin-bottom:2px">Testing Tip</h3>
          <div class="liveMeta">
            If you want Unique Visitors to go up while testing:<br>
            ‚Ä¢ Use a different browser (Chrome vs Edge)<br>
            ‚Ä¢ Use Incognito/Private and close all windows<br>
            ‚Ä¢ Or clear site data in DevTools ‚Üí Application ‚Üí Storage
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section class="section">
      <div class="card">
        <div class="sectionTitleRow">
          <h3>About Us</h3>
          <small>Ctrl + Shift + A to edit</small>
        </div>

        <div id="aboutText" class="admin-edit">
          Two Little Bees Auto Parts is a locally owned auto parts business based in Indianapolis, focused on providing quality OEM used parts pulled from real vehicles.
          <br><br>
          We specialize in VIN-verified parts, making sure every engine, transmission, module, or body component is correctly matched before it ever leaves our yard.
          That means fewer mistakes, no guesswork, and confidence that the part you‚Äôre buying is the right one.
          <br><br>
          Serving local repair shops, dealerships, and walk-in customers, we cover vehicles from 1985‚Äì2026 and maintain live inventory tied directly to the cars we dismantle.
          When you call, you talk to someone who knows parts.
          <br><br>
          Built in Indianapolis and grounded in trust ‚Äî accurate parts, straight answers, no wasted time.
        </div>
      </div>
    </section>

    <!-- TRUST + REVIEWS -->
    <section class="section" id="trust">
      <div class="card">
        <div class="sectionTitleRow">
          <h3>Trust & Reviews</h3>
          <small>What customers care about</small>
        </div>

        <div class="trustGrid">
          <div class="quoteCard">
            <p>‚ÄúWe verify fitment using VIN and vehicle data so you don‚Äôt waste time. If it doesn‚Äôt match, we‚Äôll tell you before you buy.‚Äù</p>
            <small>‚Äî Two Little Bees Auto Parts</small>

            <div class="notice" style="margin-top:12px">
              <b>Warranty / Returns:</b>
              <div style="margin-top:6px;color:var(--muted);font-weight:850;line-height:1.35">
                Ask your salesperson for warranty options on engines/transmissions and any return rules for your specific part. We keep it simple and clear at the counter.
              </div>
            </div>

            <div class="btnRow" style="margin-top:12px">
              <a class="btn secondary" target="_blank" rel="noopener"
                 href="https://www.google.com/search?q=Two+Little+Bees+Auto+Parts+Indianapolis+reviews">
                ‚≠ê View / Leave a Google Review
              </a>
              <a class="btn secondary" href="tel:3172437777">üìû Call Now</a>
            </div>
          </div>

          <div class="trustList">
            <div class="trustItem"><b>VIN-Verified Fitment</b><br><span>We match parts to real vehicles and confirm details before you pay.</span></div>
            <div class="trustItem"><b>Fast Support</b><br><span>Call ‚Äî we respond quick and keep the process simple.</span></div>
            <div class="trustItem"><b>Local & Reliable</b><br><span>Indianapolis-based. Built on repeat customers and shop relationships.</span></div>
          </div>
        </div>
      </div>
    </section>

    <!-- REQUEST A PART -->
    <section class="section" id="request">
      <div class="card">
        <div class="sectionTitleRow">
          <h3>Request a Part</h3>
          <small>We‚Äôll call you back</small>
        </div>

        <div class="miniNote">
          Fill this out and we‚Äôll contact you by phone.
        </div>

        <div class="formGrid">
          <div class="field">
            <label for="rqName">Name</label>
            <input id="rqName" type="text" placeholder="Your name" autocomplete="name">
          </div>
          <div class="field">
            <label for="rqPhone">Phone</label>
            <input id="rqPhone" type="tel" placeholder="(317) 555-1234" autocomplete="tel">
          </div>

          <div class="field">
            <label for="rqYear">Year</label>
            <input id="rqYear" type="text" placeholder="2016" inputmode="numeric">
          </div>
          <div class="field">
            <label for="rqMakeModel">Make / Model</label>
            <input id="rqMakeModel" type="text" placeholder="Chevy Malibu">
          </div>

          <div class="field">
            <label for="rqPart">Part Needed</label>
            <input id="rqPart" type="text" placeholder="Transmission, engine, bumper, wheel...">
          </div>
          <div class="field">
            <label for="rqVin">VIN (optional)</label>
            <input id="rqVin" type="text" placeholder="17-char VIN" maxlength="17" style="text-transform:uppercase;letter-spacing:.6px">
          </div>

          <div class="field full">
            <label for="rqNotes">Notes (optional)</label>
            <textarea id="rqNotes" placeholder="Any details: trim, engine size, 2WD/4WD, color, part number, etc."></textarea>
          </div>

          <div class="field full">
            <label for="rqPhotoUrl">Photo link (optional)</label>
            <input id="rqPhotoUrl" type="url" placeholder="https://... (label/photo link)">
          </div>

          <div class="modalActions full" style="margin-top:2px">
            <button class="btn primary" id="rqSubmit" type="button">Send Request</button>
            <a class="btn secondary" href="tel:3172437777" style="text-align:center">üìû Call Now</a>
          </div>
        </div>

        <div id="rqStatus" class="notice" style="display:none"></div>
      </div>
    </section>

    <!-- CASH FOR JUNK CARS -->
    <section class="section" id="junkcars">
      <div class="card">
        <div class="sectionTitleRow">
          <h3>Cash for Junk Cars</h3>
          <small>Same-day pickup (when available)</small>
        </div>

        <div class="notice">
          <b>We buy junk cars.</b> Top dollar paid. Quick pickup. Title helps ‚Äî if you‚Äôre unsure, still submit and we‚Äôll tell you what you need.
        </div>

        <div class="formGrid" style="margin-top:12px">
          <div class="field">
            <label for="jcName">Name</label>
            <input id="jcName" type="text" placeholder="Your name" autocomplete="name">
          </div>
          <div class="field">
            <label for="jcPhone">Phone</label>
            <input id="jcPhone" type="tel" placeholder="(317) 555-1234" autocomplete="tel">
          </div>

          <div class="field">
            <label for="jcLocation">Pickup Location</label>
            <input id="jcLocation" type="text" placeholder="Address or zip code">
          </div>
          <div class="field">
            <label for="jcVehicle">Vehicle (Year / Make / Model)</label>
            <input id="jcVehicle" type="text" placeholder="2010 Honda Accord">
          </div>

          <div class="field">
            <label for="jcRuns">Does it run?</label>
            <select id="jcRuns">
              <option value="">Select</option>
              <option>Yes</option>
              <option>No</option>
              <option>Not sure</option>
            </select>
          </div>
          <div class="field">
            <label for="jcTitle">Do you have the title?</label>
            <select id="jcTitle">
              <option value="">Select</option>
              <option>Yes</option>
              <option>No</option>
              <option>Not sure</option>
            </select>
          </div>

          <div class="field full">
            <label for="jcNotes">Notes (optional)</label>
            <textarea id="jcNotes" placeholder="Any info: damage, missing wheels, location details, best time to pickup, etc."></textarea>
          </div>

          <div class="modalActions full" style="margin-top:2px">
            <button class="btn primary" id="jcSubmit" type="button">Get an Offer</button>
            <a class="btn secondary" href="tel:3172437777" style="text-align:center">üìû Call Now</a>
          </div>
        </div>

        <div id="jcStatus" class="notice" style="display:none"></div>
      </div>
    </section>

    <!-- GALLERY -->
    <section class="section" style="padding-top:0">
      <div class="card">
        <div class="sectionTitleRow">
          <h3>Gallery</h3>
          <small id="galleryHint">Public view</small>
        </div>

        <div id="adminBar">
          <div class="left">
            <button class="btn secondary" id="adminLoginOpen" type="button">Admin Login</button>
            <button class="btn secondary" id="adminLogout" type="button" style="display:none">Logout</button>
            <button class="btn primary" id="addPhotoOpen" type="button" style="display:none">Add Photo</button>
          </div>

          <div class="pill bad" id="authPill">
            <span class="tinyDot"></span>
            <span id="authText">Not signed in</span>
          </div>
        </div>

        <div class="tabs" id="galleryTabs" aria-label="Gallery categories">
          <button class="tab active" type="button" data-cat="All">All</button>
          <button class="tab" type="button" data-cat="Engines">Engines</button>
          <button class="tab" type="button" data-cat="Transmissions">Transmissions</button>
          <button class="tab" type="button" data-cat="New Arrivals">New Arrivals</button>
          <button class="tab" type="button" data-cat="Yard">Yard</button>
          <button class="tab" type="button" data-cat="General">General</button>
        </div>

        <div class="galleryWrap">
          <button class="galleryNav left" id="gPrev" type="button" aria-label="Scroll left">‚Äπ</button>
          <button class="galleryNav right" id="gNext" type="button" aria-label="Scroll right">‚Ä∫</button>

          <div id="galleryGrid">
            <div class="galleryItem" id="galleryLoading">Loading gallery‚Ä¶</div>
          </div>
        </div>

        <div class="miniNote">
          Tip: Tap a photo to open full screen. Categories help customers see what you have fast.
        </div>
      </div>
    </section>

  </div>
</main>

<footer>
  <div class="footer-inner">
    <div class="footerRow">
      <span>¬© 2026 Two Little Bees Auto Parts</span>
      <span>
        üìû <a href="tel:3172437777" style="color:inherit;text-decoration:none">(317) 243-7777</a><br>
        üìç <a href="https://www.google.com/maps?q=507+S+Tibbs+Ave,+Indianapolis,+IN" target="_blank" rel="noopener" style="color:inherit;text-decoration:none">507 S Tibbs Ave, Indianapolis</a>
      </span>
    </div>

    <div class="footerLinks">
      <a href="https://twolittlebeesautoparts.github.io/OFFICIALPAGE/">Inventory</a>
      <a href="#request">Request a Part</a>
      <a href="#junkcars">Cash for Junk Cars</a>
      <a href="javascript:void(0)" onclick="toggleVin()">VIN Decoder</a>
      <a href="tel:3172437777">Call</a>
      <a href="https://www.google.com/maps?q=507+S+Tibbs+Ave,+Indianapolis,+IN" target="_blank" rel="noopener">Directions</a>
    </div>
  </div>
</footer>

<!-- Sticky CTA Dock -->
<div id="ctaDock" role="navigation" aria-label="Quick actions">
  <div class="ctaInner">
    <a class="ctaBtn" href="tel:3172437777" aria-label="Call Two Little Bees">(üìû) Call</a>
    <a class="ctaBtn" href="https://www.google.com/maps?q=507+S+Tibbs+Ave,+Indianapolis,+IN" target="_blank" rel="noopener" aria-label="Directions">(üìç) Directions</a>
    <a class="ctaBtn primary" href="#request" aria-label="Request a part">(üß∞) Quote</a>
    <a class="ctaBtn" href="#junkcars" aria-label="Cash for junk cars">(üöó) Junk</a>
  </div>
</div>

<!-- VIN -->
<div id="vin-panel-backdrop" onclick="toggleVin()"></div>
<div id="vin-panel" role="dialog" aria-modal="true" aria-label="VIN Decoder">
  <div id="vin-head">
    <strong>VIN Decoder</strong>
    <button id="vin-close" type="button" onclick="toggleVin()">Close</button>
  </div>
  <div id="vin-meta">Two Little Bees Auto Parts ‚Ä¢ (317) 243-7777 ‚Ä¢ Indianapolis</div>
  <input id="vin" maxlength="17" placeholder="ENTER 17-CHAR VIN" autocomplete="off" />
  <div id="vin-actions">
    <button class="primary" type="button" onclick="decode()">Decode VIN</button>
    <button class="secondary" type="button" onclick="printSheet()">Print VIN Sheet</button>
  </div>
  <div id="vin-status"><span class="dot"></span><span id="vin-status-text"></span></div>
  <div id="vehicle" class="vehicle"></div>
  <div id="results"></div>
</div>
<div id="print-sheet" style="display:none"></div>

<!-- Admin Login Modal -->
<div id="adminModalBackdrop"></div>
<div id="adminModal" role="dialog" aria-modal="true" aria-label="Admin Login">
  <div class="modalHead">
    <strong>Admin Login</strong>
    <button class="iconBtn" id="adminModalClose" type="button">Close</button>
  </div>
  <div class="field">
    <label for="adminEmail">Email</label>
    <input id="adminEmail" type="email" placeholder="your admin email" autocomplete="username">
  </div>
  <div class="field">
    <label for="adminPass">Password</label>
    <input id="adminPass" type="password" placeholder="your password" autocomplete="current-password">
  </div>
  <div class="modalActions">
    <button class="btn secondary" id="adminCancel" type="button">Cancel</button>
    <button class="btn primary" id="adminLoginDo" type="button">Login</button>
  </div>
  <div class="helper" id="adminMsg">Sign in using your Firebase user (Authentication ‚Üí Users).</div>
</div>

<!-- Add Photo Modal -->
<div id="addModalBackdrop"></div>
<div id="addModal" role="dialog" aria-modal="true" aria-label="Add Gallery Photo">
  <div class="modalHead">
    <strong>Add Gallery Photo</strong>
    <button class="iconBtn" id="addModalClose" type="button">Close</button>
  </div>
  <div class="field">
    <label for="photoUrl">Photo URL (public link)</label>
    <input id="photoUrl" type="url" placeholder="https://..." autocomplete="off">
  </div>
  <div class="field">
    <label for="photoCaption">Caption (optional)</label>
    <input id="photoCaption" type="text" placeholder="Engine arrivals, shop, yard, etc." autocomplete="off">
  </div>
  <div class="field">
    <label for="photoCategory">Category</label>
    <select id="photoCategory">
      <option>General</option>
      <option>Engines</option>
      <option>Transmissions</option>
      <option>New Arrivals</option>
      <option>Yard</option>
    </select>
  </div>
  <div class="modalActions">
    <button class="btn secondary" id="addCancel" type="button">Cancel</button>
    <button class="btn primary" id="addDo" type="button">Add</button>
  </div>
  <div class="helper" id="addMsg">Tip: use a direct image URL (ends in .jpg/.png/.webp) or a public Googleusercontent link.</div>
</div>

<!-- Lightbox -->
<div id="lightboxBackdrop" aria-hidden="true">
  <div id="lightboxModal" role="dialog" aria-modal="true" aria-label="Gallery image">
    <button id="lbClose" type="button" aria-label="Close">‚úï</button>
    <button class="lbArrow" id="lbPrev" type="button" aria-label="Previous">‚Äπ</button>
    <button class="lbArrow" id="lbNext" type="button" aria-label="Next">‚Ä∫</button>
    <div id="lbStage">
      <img id="lbImg" alt="Gallery large view" />
    </div>
    <div id="lbCap" class="lbCap"></div>
  </div>
</div>

<script>
/* ===== Smooth hash scrolling ===== */
(function(){
  const links = document.querySelectorAll('a[href^="#"]');
  links.forEach(a=>{
    a.addEventListener("click", (e)=>{
      const href = a.getAttribute("href");
      if(!href || href === "#") return;
      const el = document.querySelector(href);
      if(!el) return;
      e.preventDefault();
      el.scrollIntoView({ behavior:"smooth", block:"start" });
      history.pushState(null, "", href);
    });
  });
})();

/* ===== VIN Decoder ===== */
const vinPanel = document.getElementById("vin-panel");
const vinBackdrop = document.getElementById("vin-panel-backdrop");
const vinInput = document.getElementById("vin");
const resultsEl = document.getElementById("results");
const vehicleEl = document.getElementById("vehicle");
const vinStatus = document.getElementById("vin-status");
const vinStatusText = document.getElementById("vin-status-text");
const toast = document.getElementById("toast");

let vinBusy = false;
let lastVinCache = { vin:"", d:null, ts:0 };

function setVinStatus(msg, type=""){
  vinStatusText.textContent = msg || "";
  vinStatus.className = type ? type : "";
}

function toggleVin(force){
  const isOpen = vinPanel.style.display === "block";
  const next = (force === undefined) ? !isOpen : !!force;
  vinPanel.style.display = next ? "block" : "none";
  vinBackdrop.style.display = next ? "block" : "none";
  document.body.style.overflow = next ? "hidden" : "";
  if(next) setTimeout(()=> vinInput.focus(), 60);
}

document.addEventListener("keydown", (e)=>{
  if(e.key === "Escape" && vinPanel.style.display === "block") toggleVin(false);
});

function cleanVIN(v){ return (v||"").toUpperCase().replace(/[^A-Z0-9]/g,""); }
function validVIN(v){ return v.length === 17 && !/[IOQ]/.test(v); }

vinInput.addEventListener("input", ()=>{
  const c = cleanVIN(vinInput.value);
  if(vinInput.value !== c) vinInput.value = c;
  if(c.length === 17 && validVIN(c)) setVinStatus("Ready to decode.", "");
  else if(c.length) setVinStatus("Enter 17 chars (no I/O/Q).", "warn");
  else setVinStatus("", "");
});

vinInput.addEventListener("keydown", (e)=>{
  if(e.key === "Enter"){ e.preventDefault(); decode(); }
});

async function fetchDecode(v){
  const direct = `https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVinValuesExtended/${v}?format=json`;
  try{
    const r1 = await fetch(direct, { cache:"no-store" });
    if(!r1.ok) throw new Error("Direct failed");
    return await r1.json();
  }catch{
    const proxy = "https://api.allorigins.win/raw?url=" + encodeURIComponent(direct);
    const r2 = await fetch(proxy, { cache:"no-store" });
    if(!r2.ok) throw new Error("Proxy failed");
    return await r2.json();
  }
}

function escapeHtml(str){
  return String(str).replace(/[&<>"']/g, (m)=>({
    "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
  }[m]));
}

function row(k, v){
  if(!v || v === "Not Applicable") return;
  const safeK = escapeHtml(k);
  const safeV = escapeHtml(v);
  resultsEl.insertAdjacentHTML("beforeend", `
    <div class="row" data-copy="${safeV}">
      <div class="k">${safeK}</div>
      <div class="v">${safeV}</div>
    </div>
  `);
}

function showToast(msg){
  toast.textContent = msg;
  toast.style.display = "block";
  clearTimeout(showToast._t);
  showToast._t = setTimeout(()=> toast.style.display="none", 900);
}

document.addEventListener("click", async (e)=>{
  const r = e.target.closest("#results .row");
  if(!r) return;
  const text = r.getAttribute("data-copy");
  if(!text) return;
  try{
    await navigator.clipboard.writeText(text);
    showToast("Copied");
  }catch{
    const ta = document.createElement("textarea");
    ta.value = text;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand("copy");
    ta.remove();
    showToast("Copied");
  }
});

async function decode(){
  let v = cleanVIN(vinInput.value);
  vinInput.value = v;

  if(!validVIN(v)){
    setVinStatus("Invalid VIN. Must be 17 chars and no I/O/Q.", "bad");
    return;
  }
  if(vinBusy) return;
  vinBusy = true;

  const now = Date.now();
  if(lastVinCache.vin === v && lastVinCache.d && (now - lastVinCache.ts) < 60_000){
    renderVin(lastVinCache.d, v);
    setVinStatus("Loaded from cache.", "ok");
    vinBusy = false;
    return;
  }

  setVinStatus("Decoding VIN‚Ä¶", "warn");
  resultsEl.innerHTML = "";
  vehicleEl.textContent = "Decoding‚Ä¶";

  try{
    const json = await fetchDecode(v);
    const d = json?.Results?.[0] || {};
    lastVinCache = { vin:v, d, ts:Date.now() };
    renderVin(d, v);
    setVinStatus("VIN decoded successfully.", "ok");
  }catch{
    vehicleEl.textContent = "Decode failed.";
    setVinStatus("Decode failed. Check internet and try again.", "bad");
  }
  vinBusy = false;
}

function renderVin(d, v){
  const line = `${d.ModelYear || ""} ${d.Make || ""} ${d.Model || ""}`.trim() || "Vehicle";
  vehicleEl.textContent = line;

  row("VIN", v);
  row("Year", d.ModelYear);
  row("Make", d.Make);
  row("Model", d.Model);
  row("Trim", d.Trim);
  row("Engine", d.EngineModel || (d.DisplacementL ? `${d.DisplacementL}L` : ""));
  row("Displacement", d.DisplacementL ? `${d.DisplacementL} L` : "");
  row("Cylinders", d.EngineCylinders);
  row("Fuel", d.FuelTypePrimary);
  row("Transmission", d.TransmissionStyle);
  row("Trans Speeds", d.TransmissionSpeeds);
  row("Drive", d.DriveType);
  row("Body", d.BodyClass);
  row("Doors", d.Doors);
  row("Vehicle Type", d.VehicleType);
  row("GVWR", d.GVWR);
}

function printSheet(){
  const ps = document.getElementById("print-sheet");
  ps.innerHTML = `
    <div style="background:#fff;color:#000;padding:20px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif">
      <img src="https://github.com/twolittlebeesautoparts/OFFICIALPAGE/blob/main/new.logo.png?raw=true" alt="Two Little Bees" style="height:60px">
      <h2 style="margin:10px 0 6px">TWO LITTLE BEES AUTO PARTS</h2>
      <p>(317) 243-7777 ‚Ä¢ Indianapolis</p>
      <p style="margin-top:6px">507 S Tibbs Ave, Indianapolis, IN</p>
      <hr style="margin:12px 0">
      <div style="font-weight:900">${escapeHtml(vehicleEl.innerText)}</div>
      <div>${resultsEl.innerHTML}</div>
    </div>
  `;
  document.body.innerHTML = ps.outerHTML;
  window.print();
  location.reload();
}

/* ‚úÖ Local admin edit mode (localStorage only) */
let admin = false;
const editable = document.querySelectorAll(".admin-edit");
editable.forEach(el=>{
  el.contentEditable = "false";
  el.removeAttribute("contenteditable");
});
function setAdminMode(state){
  admin = !!state;
  document.body.classList.toggle("adminMode", admin);
  editable.forEach(el=>{
    el.contentEditable = admin ? "true" : "false";
    el.style.cursor = admin ? "text" : "default";
    if(!admin) el.blur();
  });
  alert(admin ? "Admin Edit Mode ON" : "Admin Edit Mode OFF");
}
document.addEventListener("keydown", (e)=>{
  if(e.ctrlKey && e.shiftKey && e.key.toLowerCase() === "a"){
    setAdminMode(!admin);
  }
});
editable.forEach(el=>{
  const saved = localStorage.getItem(el.id);
  if(saved) el.innerHTML = saved;
  el.addEventListener("blur", ()=>{
    if(admin) localStorage.setItem(el.id, el.innerHTML);
  });
});
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
  import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
  import {
    getFirestore, collection, addDoc, deleteDoc, doc,
    serverTimestamp, query, orderBy, onSnapshot,
    setDoc, getDoc, increment
  } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBbbBWg1x-RVuvfWfKBnOQPldMOWBLHXe8",
    authDomain: "twolittlebeeshomepage.firebaseapp.com",
    projectId: "twolittlebeeshomepage",
    storageBucket: "twolittlebeeshomepage.firebasestorage.app",
    messagingSenderId: "671040515864",
    appId: "1:671040515864:web:15b5b12775bb950709786d",
    measurementId: "G-362YBE5VQL"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // ====== COUNTER (FIXED) ======
  const pvNum = document.getElementById("pvNum");
  const uvNum = document.getElementById("uvNum");
  const metricsUpdated = document.getElementById("metricsUpdated");
  const metricsRef = doc(db, "metrics", "site");

  function getVisitorId(){
    const KEY = "tlb_visitor_id";
    let vid = localStorage.getItem(KEY);
    if(!vid){
      vid = (crypto?.randomUUID ? crypto.randomUUID() : ("v_" + Math.random().toString(36).slice(2)));
      localStorage.setItem(KEY, vid);
    }
    return vid;
  }

  async function trackVisit(){
    try{
      const vid = getVisitorId();

      // Always increment pageviews
      await setDoc(metricsRef, { pageviews: increment(1), updatedAt: serverTimestamp() }, { merge:true });

      // Unique visitors: only once per device/browser
      const visitorRef = doc(db, "visitors", vid);
      const exists = await getDoc(visitorRef);
      if(!exists.exists()){
        await setDoc(visitorRef, { createdAt: serverTimestamp() }, { merge:true });
        await setDoc(metricsRef, { uniqueVisitors: increment(1), updatedAt: serverTimestamp() }, { merge:true });
      }
    }catch(e){
      console.warn("Visit tracking failed:", e);
    }
  }

  // Listen and display stats (real-time)
  onSnapshot(metricsRef, (snap)=>{
    const d = snap.data() || {};
    pvNum.textContent = (d.pageviews ?? 0).toLocaleString();
    uvNum.textContent = (d.uniqueVisitors ?? 0).toLocaleString();
    metricsUpdated.textContent = d.updatedAt?.toDate ? ("Updated: " + d.updatedAt.toDate().toLocaleString()) : "Live";
  }, ()=>{
    metricsUpdated.textContent = "Stats unavailable";
  });

  // Run counter once per page load
  trackVisit();

  // ====== Your existing stuff below ======
  const galleryGrid = document.getElementById("galleryGrid");
  const galleryLoading = document.getElementById("galleryLoading");
  const gPrev = document.getElementById("gPrev");
  const gNext = document.getElementById("gNext");

  const adminLoginOpen = document.getElementById("adminLoginOpen");
  const adminLogout = document.getElementById("adminLogout");
  const addPhotoOpen = document.getElementById("addPhotoOpen");

  const authPill = document.getElementById("authPill");
  const authText = document.getElementById("authText");
  const galleryHint = document.getElementById("galleryHint");

  const adminModalBackdrop = document.getElementById("adminModalBackdrop");
  const adminModal = document.getElementById("adminModal");
  const adminModalClose = document.getElementById("adminModalClose");
  const adminCancel = document.getElementById("adminCancel");
  const adminLoginDo = document.getElementById("adminLoginDo");
  const adminEmail = document.getElementById("adminEmail");
  const adminPass = document.getElementById("adminPass");
  const adminMsg = document.getElementById("adminMsg");

  const addModalBackdrop = document.getElementById("addModalBackdrop");
  const addModal = document.getElementById("addModal");
  const addModalClose = document.getElementById("addModalClose");
  const addCancel = document.getElementById("addCancel");
  const addDo = document.getElementById("addDo");
  const photoUrl = document.getElementById("photoUrl");
  const photoCaption = document.getElementById("photoCaption");
  const photoCategory = document.getElementById("photoCategory");
  const addMsg = document.getElementById("addMsg");

  const rqSubmit = document.getElementById("rqSubmit");
  const rqStatus = document.getElementById("rqStatus");
  const jcSubmit = document.getElementById("jcSubmit");
  const jcStatus = document.getElementById("jcStatus");

  const NOTIFY_EMAIL = "josueblas971@gmail.com";

  const galleryCol = collection(db, "gallery");
  const leadsCol = collection(db, "leads");
  const junkCol = collection(db, "junkLeads");

  function show(el, on){ el.style.display = on ? "block" : "none"; }
  function lockScroll(on){ document.body.style.overflow = on ? "hidden" : ""; }

  function openLoginModal(){
    show(adminModalBackdrop,true);
    show(adminModal,true);
    adminMsg.textContent = "Sign in with your Firebase user (Authentication ‚Üí Users).";
    setTimeout(()=> adminEmail.focus(), 50);
    lockScroll(true);
  }
  function closeLoginModal(){
    show(adminModalBackdrop,false);
    show(adminModal,false);
    lockScroll(false);
  }

  function openAddModal(){
    show(addModalBackdrop,true);
    show(addModal,true);
    addMsg.textContent = "Paste a public direct image URL (jpg/png/webp).";
    setTimeout(()=> photoUrl.focus(), 50);
    lockScroll(true);
  }
  function closeAddModal(){
    show(addModalBackdrop,false);
    show(addModal,false);
    lockScroll(false);
  }

  adminLoginOpen.addEventListener("click", openLoginModal);
  adminModalClose.addEventListener("click", closeLoginModal);
  adminCancel.addEventListener("click", closeLoginModal);
  adminModalBackdrop.addEventListener("click", closeLoginModal);

  addPhotoOpen.addEventListener("click", openAddModal);
  addModalClose.addEventListener("click", closeAddModal);
  addCancel.addEventListener("click", closeAddModal);
  addModalBackdrop.addEventListener("click", closeAddModal);

  document.addEventListener("keydown", (e)=>{
    if(e.key === "Escape"){
      if(adminModal.style.display === "block") closeLoginModal();
      if(addModal.style.display === "block") closeAddModal();
    }
  });

  async function doLogin(){
    const email = (adminEmail.value || "").trim();
    const pass = adminPass.value || "";
    if(!email || !pass){
      adminMsg.textContent = "Enter email and password.";
      return;
    }
    adminLoginDo.disabled = true;
    adminMsg.textContent = "Signing in‚Ä¶";
    try{
      await signInWithEmailAndPassword(auth, email, pass);
      closeLoginModal();
    }catch(e){
      adminMsg.textContent = "Login failed: " + (e?.code || "") + " " + (e?.message || e);
      console.error(e);
    }finally{
      adminLoginDo.disabled = false;
    }
  }
  adminLoginDo.addEventListener("click", doLogin);
  adminPass.addEventListener("keydown", (e)=>{ if(e.key === "Enter") doLogin(); });

  adminLogout.addEventListener("click", async ()=>{
    try{ await signOut(auth); }catch(e){ console.error(e); }
  });

  function normalizeImgUrl(url){
    const u = (url || "").trim();
    if(!u) return "";
    try{
      const parsed = new URL(u);
      return parsed.toString();
    }catch{
      return "";
    }
  }

  async function addPhoto(){
    const url = normalizeImgUrl(photoUrl.value);
    const caption = (photoCaption.value || "").trim();
    const category = (photoCategory.value || "General").trim();
    if(!url){
      addMsg.textContent = "Paste a valid URL first.";
      return;
    }
    addDo.disabled = true;
    addMsg.textContent = "Adding‚Ä¶";
    try{
      await addDoc(galleryCol, { url, caption, category, createdAt: serverTimestamp() });
      photoUrl.value = "";
      photoCaption.value = "";
      photoCategory.value = "General";
      closeAddModal();
    }catch(e){
      addMsg.textContent = "Add failed: " + (e?.code || "") + " " + (e?.message || e);
      console.error(e);
    }finally{
      addDo.disabled = false;
    }
  }
  addDo.addEventListener("click", addPhoto);

  function updateArrows(){
    const max = galleryGrid.scrollWidth - galleryGrid.clientWidth;
    if(max <= 2){ gPrev.disabled = true; gNext.disabled = true; return; }
    gPrev.disabled = galleryGrid.scrollLeft <= 2;
    gNext.disabled = galleryGrid.scrollLeft >= (max - 2);
  }
  function scrollByCard(dir){
    const card = galleryGrid.querySelector(".galleryItem");
    const step = (card ? card.getBoundingClientRect().width : 240) + 14;
    galleryGrid.scrollBy({ left: dir * step, behavior: "smooth" });
  }
  gPrev.addEventListener("click", ()=> scrollByCard(-1));
  gNext.addEventListener("click", ()=> scrollByCard(1));
  galleryGrid.addEventListener("scroll", ()=> requestAnimationFrame(updateArrows));

  // Lightbox
  const lbBackdrop = document.getElementById("lightboxBackdrop");
  const lbImg = document.getElementById("lbImg");
  const lbCap = document.getElementById("lbCap");
  const lbClose = document.getElementById("lbClose");
  const lbPrev = document.getElementById("lbPrev");
  const lbNext = document.getElementById("lbNext");

  let lbItems = [];
  let lbIndex = 0;

  function openLightbox(index){
    if(!lbItems.length) return;
    lbIndex = Math.max(0, Math.min(index, lbItems.length - 1));
    renderLightbox();
    lbBackdrop.style.display = "block";
    lockScroll(true);
    lbBackdrop.setAttribute("aria-hidden","false");
  }
  function closeLightbox(){
    lbBackdrop.style.display = "none";
    lockScroll(false);
    lbBackdrop.setAttribute("aria-hidden","true");
  }
  function renderLightbox(){
    const item = lbItems[lbIndex];
    lbImg.src = item?.url || "";
    lbCap.textContent = item?.caption || "";
    const disabled = (lbItems.length <= 1);
    lbPrev.disabled = disabled;
    lbNext.disabled = disabled;
  }
  function prevLightbox(){
    if(lbItems.length <= 1) return;
    lbIndex = (lbIndex - 1 + lbItems.length) % lbItems.length;
    renderLightbox();
  }
  function nextLightbox(){
    if(lbItems.length <= 1) return;
    lbIndex = (lbIndex + 1) % lbItems.length;
    renderLightbox();
  }

  lbClose.addEventListener("click", closeLightbox);
  lbPrev.addEventListener("click", prevLightbox);
  lbNext.addEventListener("click", nextLightbox);
  lbBackdrop.addEventListener("click", (e)=>{ if(e.target === lbBackdrop) closeLightbox(); });
  document.addEventListener("keydown", (e)=>{
    if(lbBackdrop.style.display !== "block") return;
    if(e.key === "Escape") closeLightbox();
    if(e.key === "ArrowLeft") prevLightbox();
    if(e.key === "ArrowRight") nextLightbox();
  });

  // Category filter
  const tabs = Array.from(document.querySelectorAll("#galleryTabs .tab"));
  let activeCat = "All";
  function setActiveTab(cat){
    activeCat = cat;
    tabs.forEach(t=> t.classList.toggle("active", t.dataset.cat === cat));
    renderGallery();
  }
  tabs.forEach(t=> t.addEventListener("click", ()=> setActiveTab(t.dataset.cat || "All")));

  let snapItems = [];
  let currentUser = null;

  function addImgCard(data, isAdmin, index){
    const wrap = document.createElement("div");
    wrap.className = "galleryItem" + (isAdmin ? " admin" : "");
    wrap.style.padding = "0";

    const img = document.createElement("img");
    img.src = data.url;
    img.alt = data.caption || "Gallery photo";
    img.loading = "lazy";
    wrap.appendChild(img);

    wrap.addEventListener("click", (e)=>{
      const clickedDelete = e.target.closest(".del");
      if(clickedDelete) return;
      openLightbox(index);
    });

    const capText = (data.caption || "").trim();
    const catText = (data.category || "General").trim();

    if(capText || catText){
      const cap = document.createElement("div");
      cap.className = "cap";
      cap.textContent = capText ? capText : catText;
      wrap.appendChild(cap);
    }

    if(isAdmin && data.id){
      const del = document.createElement("button");
      del.className = "del";
      del.type = "button";
      del.textContent = "Delete";
      del.addEventListener("click", async (e)=>{
        e.stopPropagation();
        if(!confirm("Delete this photo from Firestore?")) return;
        try{ await deleteDoc(doc(db, "gallery", data.id)); }
        catch(err){ alert("Delete failed: " + (err?.message || err)); }
      });
      wrap.appendChild(del);
    }

    galleryGrid.appendChild(wrap);
  }

  function renderGallery(){
    const isAdmin = !!currentUser;
    const normalized = snapItems.map(x=>({
      ...x,
      category: (x.category || "General").trim() || "General"
    }));

    const filtered = (activeCat === "All")
      ? normalized
      : normalized.filter(x => (x.category || "General") === activeCat);

    lbItems = filtered.map(x=>({ url:x.url, caption: (x.caption || x.category || "").trim() }));

    galleryGrid.innerHTML = "";

    if(!filtered.length){
      const d = document.createElement("div");
      d.className = "galleryItem";
      d.textContent = "No photos in this category yet.";
      galleryGrid.appendChild(d);
      requestAnimationFrame(updateArrows);
      return;
    }

    filtered.forEach((item, idx)=> addImgCard(item, isAdmin, idx));
    requestAnimationFrame(updateArrows);
  }

  const q = query(galleryCol, orderBy("createdAt", "desc"));

  onSnapshot(q, (snap)=>{
    snapItems = snap.docs.map(d=> ({ id:d.id, ...d.data() })).filter(x=>x?.url);
    renderGallery();
  }, (err)=>{
    console.error(err);
    galleryGrid.innerHTML = "";
    const d = document.createElement("div");
    d.className = "galleryItem";
    d.textContent = "Gallery not loaded (check Firestore rules).";
    galleryGrid.appendChild(d);
    requestAnimationFrame(updateArrows);
  });

  onAuthStateChanged(auth, (user)=>{
    currentUser = user || null;
    const signedIn = !!user;

    adminLoginOpen.style.display = signedIn ? "none" : "inline-flex";
    adminLogout.style.display = signedIn ? "inline-flex" : "none";
    addPhotoOpen.style.display = signedIn ? "inline-flex" : "none";

    authPill.classList.toggle("ok", signedIn);
    authPill.classList.toggle("bad", !signedIn);
    authText.textContent = signedIn ? `Signed in: ${user.email || "admin"}` : "Not signed in";
    galleryHint.textContent = signedIn ? "Admin can add/delete" : "Public view";

    renderGallery();
    requestAnimationFrame(updateArrows);
  });

  if(galleryLoading) galleryLoading.remove();
  requestAnimationFrame(updateArrows);

  // ===== Email extension helper fields
  function buildEmailTextParts(payload){
    return [
      "NEW PART REQUEST",
      "----------------",
      `Name: ${payload.name || "-"}`,
      `Phone: ${payload.phone || "-"}`,
      `Vehicle: ${payload.year || "-"} ${payload.makeModel || "-"}`.trim(),
      `Part: ${payload.part || "-"}`,
      `VIN: ${payload.vin || "-"}`,
      `Photo link: ${payload.photoUrl || "-"}`,
      "",
      `Notes: ${payload.notes || "-"}`,
      "",
      "Source: Website",
      `Time: ${new Date().toLocaleString()}`
    ].join("\n");
  }

  function buildEmailTextJunk(payload){
    return [
      "NEW JUNK CAR LEAD",
      "-----------------",
      `Name: ${payload.name || "-"}`,
      `Phone: ${payload.phone || "-"}`,
      `Pickup location: ${payload.location || "-"}`,
      `Vehicle: ${payload.vehicle || "-"}`,
      `Runs: ${payload.runs || "-"}`,
      `Title: ${payload.title || "-"}`,
      "",
      `Notes: ${payload.notes || "-"}`,
      "",
      "Source: Website",
      `Time: ${new Date().toLocaleString()}`
    ].join("\n");
  }

  function setNotice(el, msg, type){
    if(!el) return;
    el.textContent = msg;
    el.className = "notice " + (type || "");
    el.style.display = "block";
  }

  function cleanPhone(p){ return String(p||"").replace(/[^\d]/g,"").slice(0, 15); }
  function cleanVin(v){ return String(v||"").toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0, 17); }
  function safeTrim(s, max){
    const t = String(s||"").trim();
    return t.length > max ? t.slice(0,max) : t;
  }

  // ===== Leads: Request a Part
  async function submitRequest(){
    const payload = {
      type: "parts_request",
      name: safeTrim(document.getElementById("rqName").value, 80),
      phone: cleanPhone(document.getElementById("rqPhone").value),
      year: safeTrim(document.getElementById("rqYear").value, 10),
      makeModel: safeTrim(document.getElementById("rqMakeModel").value, 80),
      part: safeTrim(document.getElementById("rqPart").value, 80),
      vin: cleanVin(document.getElementById("rqVin").value),
      notes: safeTrim(document.getElementById("rqNotes").value, 800),
      photoUrl: normalizeImgUrl(document.getElementById("rqPhotoUrl").value) || "",
      createdAt: serverTimestamp(),
      source: "website"
    };

    if(!payload.phone || (!payload.part && !(payload.year || payload.makeModel || payload.vin))){
      setNotice(rqStatus, "Please enter a phone number and at least a part or vehicle details.", "bad");
      return;
    }

    rqSubmit.disabled = true;
    setNotice(rqStatus, "Sending‚Ä¶", "");

    try{
      await addDoc(leadsCol, {
        ...payload,
        to: NOTIFY_EMAIL,
        subject: `New Part Request ‚Äî ${payload.part || "Part"} ‚Äî ${payload.phone || "No phone"}`,
        text: buildEmailTextParts(payload)
      });

      setNotice(rqStatus, "‚úÖ Sent! We‚Äôll call you soon.", "ok");

      document.getElementById("rqName").value = "";
      document.getElementById("rqPhone").value = "";
      document.getElementById("rqYear").value = "";
      document.getElementById("rqMakeModel").value = "";
      document.getElementById("rqPart").value = "";
      document.getElementById("rqVin").value = "";
      document.getElementById("rqNotes").value = "";
      document.getElementById("rqPhotoUrl").value = "";
    }catch(e){
      console.error(e);
      setNotice(rqStatus, "‚ùå Failed to send. Please try again or call us.", "bad");
    }finally{
      rqSubmit.disabled = false;
    }
  }
  if(rqSubmit) rqSubmit.addEventListener("click", submitRequest);

  // ===== Leads: Cash for Junk Cars
  async function submitJunk(){
    const payload = {
      type: "junk_car",
      name: safeTrim(document.getElementById("jcName").value, 80),
      phone: cleanPhone(document.getElementById("jcPhone").value),
      location: safeTrim(document.getElementById("jcLocation").value, 120),
      vehicle: safeTrim(document.getElementById("jcVehicle").value, 120),
      runs: safeTrim(document.getElementById("jcRuns").value, 20),
      title: safeTrim(document.getElementById("jcTitle").value, 20),
      notes: safeTrim(document.getElementById("jcNotes").value, 800),
      createdAt: serverTimestamp(),
      source: "website"
    };

    if(!payload.phone || !payload.vehicle || !payload.location){
      setNotice(jcStatus, "Please enter phone + pickup location + vehicle info.", "bad");
      return;
    }

    jcSubmit.disabled = true;
    setNotice(jcStatus, "Sending‚Ä¶", "");

    try{
      await addDoc(junkCol, {
        ...payload,
        to: NOTIFY_EMAIL,
        subject: `New Junk Car Lead ‚Äî ${payload.vehicle || "Vehicle"} ‚Äî ${payload.phone || "No phone"}`,
        text: buildEmailTextJunk(payload)
      });

      setNotice(jcStatus, "‚úÖ Sent! We‚Äôll call you with an offer.", "ok");

      document.getElementById("jcName").value = "";
      document.getElementById("jcPhone").value = "";
      document.getElementById("jcLocation").value = "";
      document.getElementById("jcVehicle").value = "";
      document.getElementById("jcRuns").value = "";
      document.getElementById("jcTitle").value = "";
      document.getElementById("jcNotes").value = "";
    }catch(e){
      console.error(e);
      setNotice(jcStatus, "‚ùå Failed to send. Please try again or call us.", "bad");
    }finally{
      jcSubmit.disabled = false;
    }
  }
  if(jcSubmit) jcSubmit.addEventListener("click", submitJunk);
</script>

</body>
</html>
